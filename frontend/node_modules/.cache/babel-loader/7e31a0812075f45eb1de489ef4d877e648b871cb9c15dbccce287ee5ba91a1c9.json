{"ast":null,"code":"import React from'react';import{useRef,useState,useEffect}from'react';import'../css/ProfilePic.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Profilepic(_ref){let{changeProfilePic}=_ref;const[title,setTitle]=useState('');const[image,setImage]=useState('');const[url,setUrl]=useState('');const[progress,setProgress]=useState(0);// Track the progress\nconst handleFile=useRef(null);const postData=()=>{const data=new FormData();data.append('file',image);data.append('upload_preset','bookexchange');data.append('cloud_name','okcloud');const xhr=new XMLHttpRequest();// Create XMLHttpRequest object\nxhr.upload.addEventListener('progress',e=>{if(e.lengthComputable){const percentComplete=e.loaded/e.total*100;setProgress(percentComplete.toFixed(0));// Update the progress state\n}});xhr.open('POST','https://api.cloudinary.com/v1_1/okcloud/image/upload',true);xhr.onload=()=>{if(xhr.status===200){const response=JSON.parse(xhr.responseText);setUrl(response.url);}else{console.error('Upload failed');}};xhr.send(data);// Send the request\n};const profilepicurl=()=>{fetch('/uploadprofilepic',{method:'PUT',headers:{'Content-Type':'application/json',Authorization:'Bearer '+localStorage.getItem('token')},body:JSON.stringify({pic:url})}).then(res=>res.json()).then(data=>{console.log(data);changeProfilePic();window.location.reload();}).catch(err=>console.log(err));};const handleClick=()=>{handleFile.current.click();};useEffect(()=>{if(image){postData();}},[image]);useEffect(()=>{if(url){profilepicurl();}},[url]);return/*#__PURE__*/_jsx(\"div\",{className:\"profilepic darkBg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"changePic centered\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h1\",{children:\"Change Profile Photo\"})}),/*#__PURE__*/_jsxs(\"div\",{style:{borderTop:'1px solid #00000030'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"uploadbtn\",style:{color:'#1EA1F7'},onClick:handleClick,children:\"Upload\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:handleFile,accept:\"image/*\",onChange:e=>setImage(e.target.files[0]),style:{display:'none'}})]}),progress>0&&progress<100&&/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar\",style:{marginTop:'20px',zIndex:100},children:/*#__PURE__*/_jsxs(\"div\",{className:\"progress\",style:{width:\"\".concat(progress,\"%\")},children:[progress,\"%\"]})}),/*#__PURE__*/_jsx(\"div\",{style:{borderTop:'1px solid #00000030'},children:/*#__PURE__*/_jsx(\"button\",{className:\"uploadbtn\",style:{color:'red '},onClick:()=>{setUrl(null);profilepicurl();},children:\"Remove Photo\"})}),/*#__PURE__*/_jsx(\"div\",{style:{borderTop:'1px solid #00000030'},children:/*#__PURE__*/_jsx(\"button\",{className:\"uploadbtn\",onClick:changeProfilePic,children:\"Cancel\"})})]})});}","map":{"version":3,"names":["React","useRef","useState","useEffect","jsx","_jsx","jsxs","_jsxs","Profilepic","_ref","changeProfilePic","title","setTitle","image","setImage","url","setUrl","progress","setProgress","handleFile","postData","data","FormData","append","xhr","XMLHttpRequest","upload","addEventListener","e","lengthComputable","percentComplete","loaded","total","toFixed","open","onload","status","response","JSON","parse","responseText","console","error","send","profilepicurl","fetch","method","headers","Authorization","localStorage","getItem","body","stringify","pic","then","res","json","log","window","location","reload","catch","err","handleClick","current","click","className","children","style","borderTop","color","onClick","type","ref","accept","onChange","target","files","display","marginTop","zIndex","width","concat"],"sources":["D:/react/AD/proj-clone-main/frontend/src/components/Profilepic.js"],"sourcesContent":["import React from 'react';\nimport { useRef, useState, useEffect } from 'react';\nimport '../css/ProfilePic.css';\n\nexport default function Profilepic({ changeProfilePic }) {\n  const [title, setTitle] = useState('');\n  const [image, setImage] = useState('');\n  const [url, setUrl] = useState('');\n  const [progress, setProgress] = useState(0); // Track the progress\n\n  const handleFile = useRef(null);\n\n  const postData = () => {\n    const data = new FormData();\n    data.append('file', image);\n    data.append('upload_preset', 'bookexchange');\n    data.append('cloud_name', 'okcloud');\n\n    const xhr = new XMLHttpRequest(); // Create XMLHttpRequest object\n\n    xhr.upload.addEventListener('progress', (e) => {\n      if (e.lengthComputable) {\n        const percentComplete = (e.loaded / e.total) * 100;\n        setProgress(percentComplete.toFixed(0)); // Update the progress state\n      }\n    });\n\n    xhr.open('POST', 'https://api.cloudinary.com/v1_1/okcloud/image/upload', true);\n\n    xhr.onload = () => {\n      if (xhr.status === 200) {\n        const response = JSON.parse(xhr.responseText);\n        setUrl(response.url);\n      } else {\n        console.error('Upload failed');\n      }\n    };\n\n    xhr.send(data); // Send the request\n  };\n\n  const profilepicurl = () => {\n    fetch('/uploadprofilepic', {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + localStorage.getItem('token'),\n      },\n      body: JSON.stringify({\n        pic: url,\n      }),\n    })\n      .then((res) => res.json())\n      .then((data) => {\n        console.log(data);\n        changeProfilePic();\n        window.location.reload();\n      })\n      .catch((err) => console.log(err));\n  };\n\n  const handleClick = () => {\n    handleFile.current.click();\n  };\n\n  useEffect(() => {\n    if (image) {\n      postData();\n    }\n  }, [image]);\n\n  useEffect(() => {\n    if (url) {\n      profilepicurl();\n    }\n  }, [url]);\n\n  return (\n    <div className='profilepic darkBg'>\n      <div className=\"changePic centered\">\n        <div>\n          <h1>Change Profile Photo</h1>\n        </div>\n        <div style={{ borderTop: '1px solid #00000030' }}>\n          <button className='uploadbtn' style={{ color: '#1EA1F7' }} onClick={handleClick}>\n            Upload\n          </button>\n          <input\n            type=\"file\"\n            ref={handleFile}\n            accept='image/*'\n            onChange={(e) => setImage(e.target.files[0])}\n            style={{ display: 'none' }}\n          />\n        </div>\n  \n        {/* Show the progress bar if upload is in progress */}\n        {progress > 0 && progress < 100 && (\n          <div className=\"progress-bar\" style={{ marginTop: '20px', zIndex: 100 }}>\n            <div className=\"progress\" style={{ width: `${progress}%` }}>\n              {progress}%\n            </div>\n          </div>\n        )}\n  \n        <div style={{ borderTop: '1px solid #00000030' }}>\n          <button className='uploadbtn' style={{ color: 'red ' }} onClick={() => {\n            setUrl(null);\n            profilepicurl();\n          }}>\n            Remove Photo\n          </button>\n        </div>\n        <div style={{ borderTop: '1px solid #00000030' }}>\n          <button className='uploadbtn' onClick={changeProfilePic}>\n            Cancel\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n  \n}\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,MAAM,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CACnD,MAAO,uBAAuB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE/B,cAAe,SAAS,CAAAC,UAAUA,CAAAC,IAAA,CAAuB,IAAtB,CAAEC,gBAAiB,CAAC,CAAAD,IAAA,CACrD,KAAM,CAACE,KAAK,CAAEC,QAAQ,CAAC,CAAGV,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACW,KAAK,CAAEC,QAAQ,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACa,GAAG,CAAEC,MAAM,CAAC,CAAGd,QAAQ,CAAC,EAAE,CAAC,CAClC,KAAM,CAACe,QAAQ,CAAEC,WAAW,CAAC,CAAGhB,QAAQ,CAAC,CAAC,CAAC,CAAE;AAE7C,KAAM,CAAAiB,UAAU,CAAGlB,MAAM,CAAC,IAAI,CAAC,CAE/B,KAAM,CAAAmB,QAAQ,CAAGA,CAAA,GAAM,CACrB,KAAM,CAAAC,IAAI,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC3BD,IAAI,CAACE,MAAM,CAAC,MAAM,CAAEV,KAAK,CAAC,CAC1BQ,IAAI,CAACE,MAAM,CAAC,eAAe,CAAE,cAAc,CAAC,CAC5CF,IAAI,CAACE,MAAM,CAAC,YAAY,CAAE,SAAS,CAAC,CAEpC,KAAM,CAAAC,GAAG,CAAG,GAAI,CAAAC,cAAc,CAAC,CAAC,CAAE;AAElCD,GAAG,CAACE,MAAM,CAACC,gBAAgB,CAAC,UAAU,CAAGC,CAAC,EAAK,CAC7C,GAAIA,CAAC,CAACC,gBAAgB,CAAE,CACtB,KAAM,CAAAC,eAAe,CAAIF,CAAC,CAACG,MAAM,CAAGH,CAAC,CAACI,KAAK,CAAI,GAAG,CAClDd,WAAW,CAACY,eAAe,CAACG,OAAO,CAAC,CAAC,CAAC,CAAC,CAAE;AAC3C,CACF,CAAC,CAAC,CAEFT,GAAG,CAACU,IAAI,CAAC,MAAM,CAAE,sDAAsD,CAAE,IAAI,CAAC,CAE9EV,GAAG,CAACW,MAAM,CAAG,IAAM,CACjB,GAAIX,GAAG,CAACY,MAAM,GAAK,GAAG,CAAE,CACtB,KAAM,CAAAC,QAAQ,CAAGC,IAAI,CAACC,KAAK,CAACf,GAAG,CAACgB,YAAY,CAAC,CAC7CxB,MAAM,CAACqB,QAAQ,CAACtB,GAAG,CAAC,CACtB,CAAC,IAAM,CACL0B,OAAO,CAACC,KAAK,CAAC,eAAe,CAAC,CAChC,CACF,CAAC,CAEDlB,GAAG,CAACmB,IAAI,CAACtB,IAAI,CAAC,CAAE;AAClB,CAAC,CAED,KAAM,CAAAuB,aAAa,CAAGA,CAAA,GAAM,CAC1BC,KAAK,CAAC,mBAAmB,CAAE,CACzBC,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClCC,aAAa,CAAE,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CACzD,CAAC,CACDC,IAAI,CAAEb,IAAI,CAACc,SAAS,CAAC,CACnBC,GAAG,CAAEtC,GACP,CAAC,CACH,CAAC,CAAC,CACCuC,IAAI,CAAEC,GAAG,EAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACzBF,IAAI,CAAEjC,IAAI,EAAK,CACdoB,OAAO,CAACgB,GAAG,CAACpC,IAAI,CAAC,CACjBX,gBAAgB,CAAC,CAAC,CAClBgD,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CAC1B,CAAC,CAAC,CACDC,KAAK,CAAEC,GAAG,EAAKrB,OAAO,CAACgB,GAAG,CAACK,GAAG,CAAC,CAAC,CACrC,CAAC,CAED,KAAM,CAAAC,WAAW,CAAGA,CAAA,GAAM,CACxB5C,UAAU,CAAC6C,OAAO,CAACC,KAAK,CAAC,CAAC,CAC5B,CAAC,CAED9D,SAAS,CAAC,IAAM,CACd,GAAIU,KAAK,CAAE,CACTO,QAAQ,CAAC,CAAC,CACZ,CACF,CAAC,CAAE,CAACP,KAAK,CAAC,CAAC,CAEXV,SAAS,CAAC,IAAM,CACd,GAAIY,GAAG,CAAE,CACP6B,aAAa,CAAC,CAAC,CACjB,CACF,CAAC,CAAE,CAAC7B,GAAG,CAAC,CAAC,CAET,mBACEV,IAAA,QAAK6D,SAAS,CAAC,mBAAmB,CAAAC,QAAA,cAChC5D,KAAA,QAAK2D,SAAS,CAAC,oBAAoB,CAAAC,QAAA,eACjC9D,IAAA,QAAA8D,QAAA,cACE9D,IAAA,OAAA8D,QAAA,CAAI,sBAAoB,CAAI,CAAC,CAC1B,CAAC,cACN5D,KAAA,QAAK6D,KAAK,CAAE,CAAEC,SAAS,CAAE,qBAAsB,CAAE,CAAAF,QAAA,eAC/C9D,IAAA,WAAQ6D,SAAS,CAAC,WAAW,CAACE,KAAK,CAAE,CAAEE,KAAK,CAAE,SAAU,CAAE,CAACC,OAAO,CAAER,WAAY,CAAAI,QAAA,CAAC,QAEjF,CAAQ,CAAC,cACT9D,IAAA,UACEmE,IAAI,CAAC,MAAM,CACXC,GAAG,CAAEtD,UAAW,CAChBuD,MAAM,CAAC,SAAS,CAChBC,QAAQ,CAAG/C,CAAC,EAAKd,QAAQ,CAACc,CAAC,CAACgD,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAAE,CAC7CT,KAAK,CAAE,CAAEU,OAAO,CAAE,MAAO,CAAE,CAC5B,CAAC,EACC,CAAC,CAGL7D,QAAQ,CAAG,CAAC,EAAIA,QAAQ,CAAG,GAAG,eAC7BZ,IAAA,QAAK6D,SAAS,CAAC,cAAc,CAACE,KAAK,CAAE,CAAEW,SAAS,CAAE,MAAM,CAAEC,MAAM,CAAE,GAAI,CAAE,CAAAb,QAAA,cACtE5D,KAAA,QAAK2D,SAAS,CAAC,UAAU,CAACE,KAAK,CAAE,CAAEa,KAAK,IAAAC,MAAA,CAAKjE,QAAQ,KAAI,CAAE,CAAAkD,QAAA,EACxDlD,QAAQ,CAAC,GACZ,EAAK,CAAC,CACH,CACN,cAEDZ,IAAA,QAAK+D,KAAK,CAAE,CAAEC,SAAS,CAAE,qBAAsB,CAAE,CAAAF,QAAA,cAC/C9D,IAAA,WAAQ6D,SAAS,CAAC,WAAW,CAACE,KAAK,CAAE,CAAEE,KAAK,CAAE,MAAO,CAAE,CAACC,OAAO,CAAEA,CAAA,GAAM,CACrEvD,MAAM,CAAC,IAAI,CAAC,CACZ4B,aAAa,CAAC,CAAC,CACjB,CAAE,CAAAuB,QAAA,CAAC,cAEH,CAAQ,CAAC,CACN,CAAC,cACN9D,IAAA,QAAK+D,KAAK,CAAE,CAAEC,SAAS,CAAE,qBAAsB,CAAE,CAAAF,QAAA,cAC/C9D,IAAA,WAAQ6D,SAAS,CAAC,WAAW,CAACK,OAAO,CAAE7D,gBAAiB,CAAAyD,QAAA,CAAC,QAEzD,CAAQ,CAAC,CACN,CAAC,EACH,CAAC,CACH,CAAC,CAGV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}