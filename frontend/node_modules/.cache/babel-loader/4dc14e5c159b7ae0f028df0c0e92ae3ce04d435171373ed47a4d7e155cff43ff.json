{"ast":null,"code":"import React,{useState,useEffect}from'react';import'../css/Profile.css';import PostDetail from'../components/PostDetail';import Profilepic from'../components/Profilepic';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Profile(){const defaultpic=\"https://th.bing.com/th/id/OIP.SAcV4rjQCseubnk32USHigHaHx?rs=1&pid=ImgDetMain\";const[pic,setPic]=useState([]);const[show,setShow]=useState(false);const[posts,setPosts]=useState([]);const[user,setUser]=useState(\"\");const[changePic,setChangePic]=useState(false);const[uploading,setUploading]=useState(false);const[progress,setProgress]=useState(0);const toggleshow=posts=>{if(show){setShow(false);}else{setShow(true);setPosts(posts);}};useEffect(()=>{fetch(\"/user/\".concat(JSON.parse(localStorage.getItem(\"user\"))._id),{headers:{\"Authorization\":\"Bearer \"+localStorage.getItem(\"token\")}}).then(res=>res.json()).then(result=>{setPic(result.post);setUser(result.user);});},[changePic,pic]);const ChangeProfile=()=>{setChangePic(!changePic);};const handleImageUpload=event=>{const file=event.target.files[0];if(!file)return;const formData=new FormData();formData.append('profilePic',file);setUploading(true);const xhr=new XMLHttpRequest();xhr.open('POST','/uploadProfilePic',true);xhr.upload.onprogress=event=>{if(event.lengthComputable){const percentComplete=Math.round(event.loaded/event.total*100);setProgress(percentComplete);}};xhr.onload=()=>{if(xhr.status===200){// Handle success\nsetUploading(false);setChangePic(false);// Optionally, refresh the user profile\nfetch(\"/user/\".concat(JSON.parse(localStorage.getItem(\"user\"))._id),{headers:{\"Authorization\":\"Bearer \"+localStorage.getItem(\"token\")}}).then(res=>res.json()).then(result=>{setPic(result.post);setUser(result.user);});}else{// Handle error\nsetUploading(false);}};xhr.send(formData);};return/*#__PURE__*/_jsxs(\"div\",{className:\"profile\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-frame\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-pic\",children:[/*#__PURE__*/_jsx(\"img\",{onClick:ChangeProfile,src:user.photo?user.photo:defaultpic,alt:\"Profile\"}),changePic&&/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleImageUpload,style:{display:'none'},id:\"file-input\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-data\",children:[/*#__PURE__*/_jsx(\"h1\",{children:JSON.parse(localStorage.getItem('user')).name}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-info\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[pic?pic.length:\"0\",\" post\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[user.followers?user.followers.length:\"0\",\" followers\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[user.following?user.following.length:\"0\",\" following\"]})]})]})]}),/*#__PURE__*/_jsx(\"hr\",{style:{width:\"100%\",margin:\"25px auto\",opacity:\"0.8\"}}),/*#__PURE__*/_jsx(\"div\",{className:\"gallery\",children:pic.map(pics=>/*#__PURE__*/_jsx(\"img\",{src:pics.photo,onClick:()=>{toggleshow(pics);},alt:\"Post\"},pics._id))}),show&&/*#__PURE__*/_jsx(PostDetail,{item:posts,toggleshow:toggleshow}),changePic&&/*#__PURE__*/_jsx(Profilepic,{changeProfilePic:ChangeProfile}),uploading&&/*#__PURE__*/_jsx(\"div\",{className:\"progress-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"progress-bar\",style:{width:\"\".concat(progress,\"%\")},children:[progress,\"%\"]})})]});}","map":{"version":3,"names":["React","useState","useEffect","PostDetail","Profilepic","jsx","_jsx","jsxs","_jsxs","Profile","defaultpic","pic","setPic","show","setShow","posts","setPosts","user","setUser","changePic","setChangePic","uploading","setUploading","progress","setProgress","toggleshow","fetch","concat","JSON","parse","localStorage","getItem","_id","headers","then","res","json","result","post","ChangeProfile","handleImageUpload","event","file","target","files","formData","FormData","append","xhr","XMLHttpRequest","open","upload","onprogress","lengthComputable","percentComplete","Math","round","loaded","total","onload","status","send","className","children","onClick","src","photo","alt","type","accept","onChange","style","display","id","name","length","followers","following","width","margin","opacity","map","pics","item","changeProfilePic"],"sources":["D:/react/AD/proj-clone-main/frontend/src/screens/Profile.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport '../css/Profile.css';\nimport PostDetail from '../components/PostDetail';\nimport Profilepic from '../components/Profilepic';\n\nexport default function Profile() {\n  const defaultpic = \"https://th.bing.com/th/id/OIP.SAcV4rjQCseubnk32USHigHaHx?rs=1&pid=ImgDetMain\";\n  const [pic, setPic] = useState([]);\n  const [show, setShow] = useState(false);\n  const [posts, setPosts] = useState([]);\n  const [user, setUser] = useState(\"\");\n  const [changePic, setChangePic] = useState(false);\n  const [uploading, setUploading] = useState(false);\n  const [progress, setProgress] = useState(0);\n\n  const toggleshow = (posts) => {\n    if (show) {\n      setShow(false);\n    } else {\n      setShow(true);\n      setPosts(posts);\n    }\n  };\n\n  useEffect(() => {\n    fetch(`/user/${JSON.parse(localStorage.getItem(\"user\"))._id}`, {\n      headers: {\n        \"Authorization\": \"Bearer \" + localStorage.getItem(\"token\"),\n      },\n    }).then(res => res.json())\n      .then(result => {\n        setPic(result.post);\n        setUser(result.user);\n      });\n  }, [changePic, pic]);\n\n  const ChangeProfile = () => {\n    setChangePic(!changePic);\n  };\n\n  const handleImageUpload = (event) => {\n    const file = event.target.files[0];\n    if (!file) return;\n\n    const formData = new FormData();\n    formData.append('profilePic', file);\n\n    setUploading(true);\n    const xhr = new XMLHttpRequest();\n\n    xhr.open('POST', '/uploadProfilePic', true);\n\n    xhr.upload.onprogress = (event) => {\n      if (event.lengthComputable) {\n        const percentComplete = Math.round((event.loaded / event.total) * 100);\n        setProgress(percentComplete);\n      }\n    };\n\n    xhr.onload = () => {\n      if (xhr.status === 200) {\n        // Handle success\n        setUploading(false);\n        setChangePic(false);\n        // Optionally, refresh the user profile\n        fetch(`/user/${JSON.parse(localStorage.getItem(\"user\"))._id}`, {\n          headers: {\n            \"Authorization\": \"Bearer \" + localStorage.getItem(\"token\"),\n          },\n        }).then(res => res.json())\n          .then(result => {\n            setPic(result.post);\n            setUser(result.user);\n          });\n      } else {\n        // Handle error\n        setUploading(false);\n      }\n    };\n\n    xhr.send(formData);\n  };\n\n  return (\n    <div className='profile'>\n      <div className=\"profile-frame\">\n        <div className=\"profile-pic\">\n          <img\n            onClick={ChangeProfile}\n            src={user.photo ? user.photo : defaultpic}\n            alt=\"Profile\"\n          />\n          {changePic && (\n            <input\n              type=\"file\"\n              accept=\"image/*\"\n              onChange={handleImageUpload}\n              style={{ display: 'none' }}\n              id=\"file-input\"\n            />\n          )}\n        </div>\n        <div className=\"profile-data\">\n          <h1>{JSON.parse(localStorage.getItem('user')).name}</h1>\n          <div className=\"profile-info\">\n            <p>{pic ? pic.length : \"0\"} post</p>\n            <p>{user.followers ? user.followers.length : \"0\"} followers</p>\n            <p>{user.following ? user.following.length : \"0\"} following</p>\n          </div>\n        </div>\n      </div>\n      <hr style={{\n        width: \"100%\",\n        margin: \"25px auto\",\n        opacity: \"0.8\"\n      }} />\n      <div className=\"gallery\">\n        {pic.map((pics) => (\n          <img key={pics._id} src={pics.photo} onClick={() => { toggleshow(pics) }} alt=\"Post\" />\n        ))}\n      </div>\n      {show &&\n        <PostDetail item={posts} toggleshow={toggleshow} />\n      }\n      {changePic &&\n        <Profilepic changeProfilePic={ChangeProfile} />\n      }\n      {uploading && (\n        <div className=\"progress-container\">\n          <div className=\"progress-bar\" style={{ width: `${progress}%` }}>\n            {progress}%\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}