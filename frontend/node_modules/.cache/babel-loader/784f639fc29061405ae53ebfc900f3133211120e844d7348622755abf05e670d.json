{"ast":null,"code":"import React from'react';import{useRef,useState,useEffect}from'react';import'../css/ProfilePic.css';import Loader from'react-loader-spinner';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Profilepic(_ref){let{changeProfilePic}=_ref;const[title,setTitle]=useState(\"\");const[image,setImage]=useState(\"\");const[url,setUrl]=useState(\"\");// const [process, setProcess] = useRef(false)\nconst[imageUploaded,setImageUploaded]=useState(false);const handleFile=useRef(null);const postData=()=>{const data=new FormData();data.append('file',image);data.append(\"upload_preset\",\"bookexchange\");data.append(\"cloud_name\",\"okcloud\");fetch(\"https://api.cloudinary.com/v1_1/okcloud/image/upload\",{method:\"post\",body:data}).then(res=>res.json()).then(data=>setUrl(data.url)).catch(err=>console.log(err));console.log(url);};const profilepicurl=()=>{fetch('/uploadprofilepic',{method:'put',headers:{'Content-Type':'application/json',Authorization:'Bearer '+localStorage.getItem('token')},body:JSON.stringify({pic:url})}).then(res=>res.json()).then(data=>{console.log(data);changeProfilePic();window.location.reload();}).catch(err=>console.log(err));};const handleClick=()=>{handleFile.current.click();};useEffect(()=>{if(image){postData();setImageUploaded(true);}},[image]);useEffect(()=>{if(url){profilepicurl();}},[url]);return/*#__PURE__*/_jsx(\"div\",{className:\"profilepic darkBg\",children:imageUploaded?/*#__PURE__*/_jsx(\"div\",{className:\"process-bar\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"process\",children:[/*#__PURE__*/_jsx(Loader,{type:\"TailSpin\",color:\"#4fa94d\",height:80,width:80}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"})]})}):/*#__PURE__*/_jsxs(\"div\",{className:\"changePic centered\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h1\",{children:\"Change Profile Photo\"})}),/*#__PURE__*/_jsxs(\"div\",{style:{borderTop:'1px solid #00000030'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"uploadbtn\",style:{color:\"#1EA1F7\"},onClick:handleClick,children:\"Upload \"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:handleFile,accept:\"image/*\",onChange:e=>{setImage(e.target.files[0]);},style:{display:\"none\"}})]}),/*#__PURE__*/_jsx(\"div\",{style:{borderTop:'1px solid #00000030'},children:/*#__PURE__*/_jsx(\"button\",{className:\"uploadbtn\",style:{color:'red '},onClick:()=>{setUrl(null);profilepicurl();},children:\"Remove Photo\"})}),/*#__PURE__*/_jsx(\"div\",{style:{borderTop:'1px solid #00000030'},children:/*#__PURE__*/_jsx(\"button\",{className:\"uploadbtn\",style:{},onClick:changeProfilePic,children:\"Cancel\"})})]})});}","map":{"version":3,"names":["React","useRef","useState","useEffect","Loader","jsx","_jsx","jsxs","_jsxs","Profilepic","_ref","changeProfilePic","title","setTitle","image","setImage","url","setUrl","imageUploaded","setImageUploaded","handleFile","postData","data","FormData","append","fetch","method","body","then","res","json","catch","err","console","log","profilepicurl","headers","Authorization","localStorage","getItem","JSON","stringify","pic","window","location","reload","handleClick","current","click","className","children","type","color","height","width","style","borderTop","onClick","ref","accept","onChange","e","target","files","display"],"sources":["D:/react/AD/proj-clone-main/frontend/src/components/Profilepic.js"],"sourcesContent":["import React from 'react'\nimport { useRef, useState, useEffect } from 'react'\nimport '../css/ProfilePic.css'\nimport Loader from 'react-loader-spinner';\n\nexport default function Profilepic({changeProfilePic}) {\nconst [title, setTitle] = useState(\"\");\nconst [image, setImage] = useState(\"\");\nconst [url, setUrl] = useState(\"\");\n// const [process, setProcess] = useRef(false)\nconst [imageUploaded, setImageUploaded] = useState(false);\n\n    const handleFile= useRef(null)\n\n    const postData = () => {\n        const data = new FormData()\n        data.append('file',image)\n        data.append(\"upload_preset\",\"bookexchange\")\n        data.append(\"cloud_name\",\"okcloud\")\n        fetch(\"https://api.cloudinary.com/v1_1/okcloud/image/upload\",\n            {\n                method:\"post\",\n                body:data\n            })\n            .then(res=>res.json())\n            .then(data=>setUrl(data.url))\n            .catch(err=>console.log(err))\n        console.log(url)\n    }\n\n    const profilepicurl=()=>{\n        fetch('/uploadprofilepic', {\n            method: 'put',\n            headers: {\n              'Content-Type': 'application/json',\n              Authorization: 'Bearer ' + localStorage.getItem('token'),\n            },\n            body: JSON.stringify({\n              pic:url\n            }),\n          })\n            .then((res) =>res.json())\n            .then((data) =>{\n                console.log(data)\n                changeProfilePic()\n                window.location.reload()\n                \n            })\n            .catch(err=>console.log(err))\n    }\n\n    const handleClick =()=>{\n        handleFile.current.click()\n    }\n\n    useEffect(()=>{\n        if(image){\n            postData()\n            setImageUploaded(true)\n        }\n    },[image])\n\n    useEffect(()=>{\n        if(url){\n            profilepicurl()\n            \n        }\n    },[url])\n   \n  return (\n    <div className='profilepic darkBg'>\n        {(imageUploaded) ? (<div className='process-bar'>\n            <div className='process'>\n            <Loader\n            type=\"TailSpin\"\n            color=\"#4fa94d\"\n            height={80}\n            width={80}\n          />\n          <p>Loading...</p>\n            </div>\n        </div>) : (\n            <div className=\"changePic centered\">\n            <div>\n                <h1>Change Profile Photo</h1>\n            </div>\n            <div style={{borderTop:'1px solid #00000030'}}>\n                <button className='uploadbtn' style={{color: \"#1EA1F7\"}} onClick={handleClick}>Upload </button>\n                <input type=\"file\" ref={handleFile} accept='image/*' onChange={(e)=>{\n                    setImage(e.target.files[0])\n                }} style={{display: \"none\"}} /> \n            </div>\n            <div style={{borderTop:'1px solid #00000030'}}>\n                <button className='uploadbtn' style={{color: 'red '}} onClick={()=>{\n                    setUrl(null);\n                    profilepicurl()\n                }}>Remove Photo</button>\n            </div>\n            <div style={{borderTop:'1px solid #00000030'}}>\n                <button className='uploadbtn' style={{}} onClick={changeProfilePic}>Cancel</button>\n            </div>\n            \n        </div>\n        )}\n        \n    </div>\n  )\n}\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,MAAM,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CACnD,MAAO,uBAAuB,CAC9B,MAAO,CAAAC,MAAM,KAAM,sBAAsB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE1C,cAAe,SAAS,CAAAC,UAAUA,CAAAC,IAAA,CAAqB,IAApB,CAACC,gBAAgB,CAAC,CAAAD,IAAA,CACrD,KAAM,CAACE,KAAK,CAAEC,QAAQ,CAAC,CAAGX,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACY,KAAK,CAAEC,QAAQ,CAAC,CAAGb,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACc,GAAG,CAAEC,MAAM,CAAC,CAAGf,QAAQ,CAAC,EAAE,CAAC,CAClC;AACA,KAAM,CAACgB,aAAa,CAAEC,gBAAgB,CAAC,CAAGjB,QAAQ,CAAC,KAAK,CAAC,CAErD,KAAM,CAAAkB,UAAU,CAAEnB,MAAM,CAAC,IAAI,CAAC,CAE9B,KAAM,CAAAoB,QAAQ,CAAGA,CAAA,GAAM,CACnB,KAAM,CAAAC,IAAI,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC3BD,IAAI,CAACE,MAAM,CAAC,MAAM,CAACV,KAAK,CAAC,CACzBQ,IAAI,CAACE,MAAM,CAAC,eAAe,CAAC,cAAc,CAAC,CAC3CF,IAAI,CAACE,MAAM,CAAC,YAAY,CAAC,SAAS,CAAC,CACnCC,KAAK,CAAC,sDAAsD,CACxD,CACIC,MAAM,CAAC,MAAM,CACbC,IAAI,CAACL,IACT,CAAC,CAAC,CACDM,IAAI,CAACC,GAAG,EAAEA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACrBF,IAAI,CAACN,IAAI,EAAEL,MAAM,CAACK,IAAI,CAACN,GAAG,CAAC,CAAC,CAC5Be,KAAK,CAACC,GAAG,EAAEC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC,CAAC,CACjCC,OAAO,CAACC,GAAG,CAAClB,GAAG,CAAC,CACpB,CAAC,CAED,KAAM,CAAAmB,aAAa,CAACA,CAAA,GAAI,CACpBV,KAAK,CAAC,mBAAmB,CAAE,CACvBC,MAAM,CAAE,KAAK,CACbU,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClCC,aAAa,CAAE,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CACzD,CAAC,CACDZ,IAAI,CAAEa,IAAI,CAACC,SAAS,CAAC,CACnBC,GAAG,CAAC1B,GACN,CAAC,CACH,CAAC,CAAC,CACCY,IAAI,CAAEC,GAAG,EAAIA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACxBF,IAAI,CAAEN,IAAI,EAAI,CACXW,OAAO,CAACC,GAAG,CAACZ,IAAI,CAAC,CACjBX,gBAAgB,CAAC,CAAC,CAClBgC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CAE5B,CAAC,CAAC,CACDd,KAAK,CAACC,GAAG,EAAEC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC,CAAC,CACrC,CAAC,CAED,KAAM,CAAAc,WAAW,CAAEA,CAAA,GAAI,CACnB1B,UAAU,CAAC2B,OAAO,CAACC,KAAK,CAAC,CAAC,CAC9B,CAAC,CAED7C,SAAS,CAAC,IAAI,CACV,GAAGW,KAAK,CAAC,CACLO,QAAQ,CAAC,CAAC,CACVF,gBAAgB,CAAC,IAAI,CAAC,CAC1B,CACJ,CAAC,CAAC,CAACL,KAAK,CAAC,CAAC,CAEVX,SAAS,CAAC,IAAI,CACV,GAAGa,GAAG,CAAC,CACHmB,aAAa,CAAC,CAAC,CAEnB,CACJ,CAAC,CAAC,CAACnB,GAAG,CAAC,CAAC,CAEV,mBACEV,IAAA,QAAK2C,SAAS,CAAC,mBAAmB,CAAAC,QAAA,CAC5BhC,aAAa,cAAKZ,IAAA,QAAK2C,SAAS,CAAC,aAAa,CAAAC,QAAA,cAC5C1C,KAAA,QAAKyC,SAAS,CAAC,SAAS,CAAAC,QAAA,eACxB5C,IAAA,CAACF,MAAM,EACP+C,IAAI,CAAC,UAAU,CACfC,KAAK,CAAC,SAAS,CACfC,MAAM,CAAE,EAAG,CACXC,KAAK,CAAE,EAAG,CACX,CAAC,cACFhD,IAAA,MAAA4C,QAAA,CAAG,YAAU,CAAG,CAAC,EACV,CAAC,CACL,CAAC,cACF1C,KAAA,QAAKyC,SAAS,CAAC,oBAAoB,CAAAC,QAAA,eACnC5C,IAAA,QAAA4C,QAAA,cACI5C,IAAA,OAAA4C,QAAA,CAAI,sBAAoB,CAAI,CAAC,CAC5B,CAAC,cACN1C,KAAA,QAAK+C,KAAK,CAAE,CAACC,SAAS,CAAC,qBAAqB,CAAE,CAAAN,QAAA,eAC1C5C,IAAA,WAAQ2C,SAAS,CAAC,WAAW,CAACM,KAAK,CAAE,CAACH,KAAK,CAAE,SAAS,CAAE,CAACK,OAAO,CAAEX,WAAY,CAAAI,QAAA,CAAC,SAAO,CAAQ,CAAC,cAC/F5C,IAAA,UAAO6C,IAAI,CAAC,MAAM,CAACO,GAAG,CAAEtC,UAAW,CAACuC,MAAM,CAAC,SAAS,CAACC,QAAQ,CAAGC,CAAC,EAAG,CAChE9C,QAAQ,CAAC8C,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAC/B,CAAE,CAACR,KAAK,CAAE,CAACS,OAAO,CAAE,MAAM,CAAE,CAAE,CAAC,EAC9B,CAAC,cACN1D,IAAA,QAAKiD,KAAK,CAAE,CAACC,SAAS,CAAC,qBAAqB,CAAE,CAAAN,QAAA,cAC1C5C,IAAA,WAAQ2C,SAAS,CAAC,WAAW,CAACM,KAAK,CAAE,CAACH,KAAK,CAAE,MAAM,CAAE,CAACK,OAAO,CAAEA,CAAA,GAAI,CAC/DxC,MAAM,CAAC,IAAI,CAAC,CACZkB,aAAa,CAAC,CAAC,CACnB,CAAE,CAAAe,QAAA,CAAC,cAAY,CAAQ,CAAC,CACvB,CAAC,cACN5C,IAAA,QAAKiD,KAAK,CAAE,CAACC,SAAS,CAAC,qBAAqB,CAAE,CAAAN,QAAA,cAC1C5C,IAAA,WAAQ2C,SAAS,CAAC,WAAW,CAACM,KAAK,CAAE,CAAC,CAAE,CAACE,OAAO,CAAE9C,gBAAiB,CAAAuC,QAAA,CAAC,QAAM,CAAQ,CAAC,CAClF,CAAC,EAEL,CACJ,CAEA,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}